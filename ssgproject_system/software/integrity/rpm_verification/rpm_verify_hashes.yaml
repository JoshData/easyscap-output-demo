id: xccdf_org.ssgproject.content_rule_rpm_verify_hashes
severity: low
title: Verify File Hashes with RPM
description: |
  The RPM package management system can check the hashes of installed
  software packages, including many that are important to system security.
  Run the following command to list which files on the system have hashes
  that differ from what is expected by the RPM database:

      # rpm -Va | grep '^..5'

  A “c” in the second column indicates that a file is a configuration
  file, which may appropriately be expected to change. If the file was not
  expected to change, investigate the cause of the change using audit logs
  or other means. The package can then be reinstalled to restore the file.
  Run the following command to determine which package owns the file:

      # rpm -qf FILENAME

  The package can be reinstalled from a yum repository using the command:

      yum reinstall PACKAGENAME

  Alternatively, the package can be reinstalled from trusted media using
  the command:

      rpm -Uvh PACKAGENAME
rationale: |
  The hashes of important files like system executables should match the
  information given by the RPM database. Executables with erroneous hashes
  could be a sign of nefarious activity on the system.
references:
- href: http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf
  value: CM-6(d)
- href: http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf
  value: CM-6(3)
- href: http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf
  value: SI-7
- href: http://iase.disa.mil/cci/index.html
  value: '1496'
crosswalk:
- system: http://cce.mitre.org
  value: CCE-27223-7
tests:
- type: linux:rpmverifyfile_test
  check: all
  check_existence: none_exist
  comment: verify file md5 hashes
  version: '1'
  object:
    comment: rpm verify of all files
    version: '1'
    linux:behaviors:
      nomd5: 'false'
    linux:name:
      operation: pattern match
      value: .*
    linux:filepath:
      operation: pattern match
      value: ^.*bin/.*$
    oval:filter:
      action: include
      value:
        type: linux:rpmverifyfile_state
        operator: AND
        version: '1'
        linux:md5_differs: fail
