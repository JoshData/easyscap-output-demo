id: xccdf_org.ssgproject.content_rule_disable_avahi
severity: low
title: Disable Avahi Server Software
description: |
  The `avahi-daemon` service can be disabled with the following command:

      # chkconfig avahi-daemon off
rationale: |
  Because the Avahi daemon service keeps an open network port, it is
  subject to network attacks. Its functionality is convenient but is only
  appropriate if the local network can be trusted.
references:
- href: http://csrc.nist.gov/publications/nistpubs/800-53-Rev3/sp800-53-rev3-final.pdf
  value: CM-7
- href: http://iase.disa.mil/cci/index.html
  value: '366'
crosswalk:
- system: http://cce.mitre.org
  value: CCE-27087-6
tests:
- type: unix:runlevel_test
  check: all
  check_existence: any_exist
  comment: Runlevel test
  version: '2'
  object:
    version: '1'
    unix:service_name: avahi-daemon
    unix:runlevel:
      operation: equals
      value: '0'
  state:
    comment: not configured to start
    version: '1'
    unix:start: false
    unix:kill: true
- type: unix:runlevel_test
  check: all
  check_existence: any_exist
  comment: Runlevel test
  version: '2'
  object:
    version: '1'
    unix:service_name: avahi-daemon
    unix:runlevel:
      operation: equals
      value: '1'
  state:
    comment: not configured to start
    version: '1'
    unix:start: false
    unix:kill: true
- type: unix:runlevel_test
  check: all
  check_existence: any_exist
  comment: Runlevel test
  version: '2'
  object:
    version: '1'
    unix:service_name: avahi-daemon
    unix:runlevel:
      operation: equals
      value: '2'
  state:
    comment: not configured to start
    version: '1'
    unix:start: false
    unix:kill: true
- type: unix:runlevel_test
  check: all
  check_existence: any_exist
  comment: Runlevel test
  version: '2'
  object:
    version: '1'
    unix:service_name: avahi-daemon
    unix:runlevel:
      operation: equals
      value: '3'
  state:
    comment: not configured to start
    version: '1'
    unix:start: false
    unix:kill: true
- type: unix:runlevel_test
  check: all
  check_existence: any_exist
  comment: Runlevel test
  version: '2'
  object:
    version: '1'
    unix:service_name: avahi-daemon
    unix:runlevel:
      operation: equals
      value: '4'
  state:
    comment: not configured to start
    version: '1'
    unix:start: false
    unix:kill: true
- type: unix:runlevel_test
  check: all
  check_existence: any_exist
  comment: Runlevel test
  version: '2'
  object:
    version: '1'
    unix:service_name: avahi-daemon
    unix:runlevel:
      operation: equals
      value: '5'
  state:
    comment: not configured to start
    version: '1'
    unix:start: false
    unix:kill: true
- type: unix:runlevel_test
  check: all
  check_existence: any_exist
  comment: Runlevel test
  version: '2'
  object:
    version: '1'
    unix:service_name: avahi-daemon
    unix:runlevel:
      operation: equals
      value: '6'
  state:
    comment: not configured to start
    version: '1'
    unix:start: false
    unix:kill: true
